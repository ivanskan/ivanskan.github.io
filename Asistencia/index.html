<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pkcorp | Asistencia</title>
  <link rel="stylesheet" href="style.css">

  <!-- Librerías externas -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" 
        rel="stylesheet" 
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" 
        crossorigin="anonymous">
</head>
<body class="container px-0">

  <h2 class="mt-3 mb-4 text-center">LISTA DE ASISTENCIA</h2>

  <!-- Cargar Excel -->
  <div class="mb-3 col-12 col-md-4">
    <input class="form-control form-control-sm" type="file" id="input-excel" accept=".xlsx">
  </div>

  <!-- Contenedor dinámico de registros -->
  <div id="registro"></div>

  <!-- Barra de búsqueda y acciones -->
  <div class="d-flex justify-content-between mb-4 mt-4">
    <div class="row g-3 align-items-center">
      <div class="col-auto">
        <label for="dni-input" class="col-form-label">Ingrese DNI: </label>
      </div>
      <div class="col-auto">
        <div class="d-flex">
          <input type="text" id="dni-input" class="form-control" maxlength="8">
          <button class="btn btn-primary mx-2" onclick="registrarAsistencia()">Registrar</button>
        </div>
      </div>
    
    </div>
    <div class="row align-items-center">
      <button id="btnMostrarAgregar" class="btn btn-primary">Agregar participante</button>
      <button id="btnMostrarLista" class="btn btn-primary d-none">Volver a lista</button>
    </div>
  </div>

  <!-- Formulario Agregar participante -->
  <div id="formAgregar" class="d-none">
    <form id="form-participante">
      <div class="row mb-3">
        <label for="inputNuevoDNI" class="col-sm-2 col-form-label">DNI</label>
        <div class="col-sm-10">
          <input type="text" class="form-control" id="inputNuevoDNI" maxlength="8">
        </div>
      </div>
      <div class="row mb-3">
        <label for="inputNuevoNombre" class="col-sm-2 col-form-label">Apellidos y Nombres</label>
        <div class="col-sm-10">
          <input type="text" class="form-control" id="inputNuevoNombre">
        </div>
      </div>
      <div class="row mb-3">
        <label for="inputNuevoPuesto" class="col-sm-2 col-form-label">Puesto</label>
        <div class="col-sm-10">
          <input type="text" class="form-control" id="inputNuevoPuesto">
        </div>
      </div>
      <div class="row mb-3">
        <label for="inputNuevoEmpresa" class="col-sm-2 col-form-label">Empresa</label>
        <div class="col-sm-10">
          <input type="text" class="form-control" id="inputNuevoEmpresa">
        </div>
      </div>
      <div class="row mb-3">
        <label for="inputNuevoFecha" class="col-sm-2 col-form-label">Fecha</label>
        <div class="col-sm-10">
          <input type="text" class="form-control" id="inputNuevoFecha" placeholder="dd-mm-yyyy">
        </div>
      </div>
      <button type="submit" class="btn btn-primary">Guardar</button>
    </form>
  </div>

  <!-- Mensajes y tabla -->
  <div id="mensaje"></div>
  <div id="tabla-container"></div>

  <!-- Descargar Excel -->
  <button id="descargar-btn" class="btn btn-primary my-3 d-none">Descargar Excel</button>

  <!-- Scripts -->
  <script src="app.js"></script>
</body>
</html>
